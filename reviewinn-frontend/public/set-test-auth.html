<!DOCTYPE html>
<html>
<head>
    <title>Set Test Auth</title>
</head>
<body>
    <h1>Set Test Authentication</h1>
    <button onclick="setTestAuth()">Set Test Auth Token</button>
    <button onclick="clearAuth()">Clear Auth</button>
    <button onclick="checkAuth()">Check Current Auth</button>
    <button onclick="testAPI()">Test Notifications API</button>
    <pre id="output"></pre>
    
    <script>
        const testToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIzMCIsImVtYWlsIjoiam9obkBleGFtcGxlLmNvbSIsImV4cCI6MTc1NTIzODAxNSwiaWF0IjoxNzU1MjM0NDE1LCJpc3MiOiJyZXZpZXdpbm4tYXBpIiwiYXVkIjoicmV2aWV3aW5uLWZyb250ZW5kIiwidHlwZSI6ImFjY2VzcyIsImp0aSI6Il9uV2VqZHNKWDQ2ZURrSEd4M1d6eHcifQ.Vk0mc9VLWPJEjsJ8kYo8OHOzMEoizP-9rE88npvTaqE";
        const testUser = {
            id: "30",
            username: "john",
            email: "john@example.com",
            name: "John Smith",
            avatar: null,
            level: 1,
            points: 0,
            isVerified: false,
            preferences: {},
            stats: {},
            createdAt: new Date().toISOString(),
            badges: [],
            following: [],
            followers: []
        };
        
        function log(message) {
            document.getElementById('output').textContent = JSON.stringify(message, null, 2) + '\n';
        }
        
        function setTestAuth() {
            localStorage.setItem('reviewinn_jwt_token', testToken);
            localStorage.setItem('reviewinn_user_data', JSON.stringify(testUser));
            localStorage.setItem('auth-storage', JSON.stringify({
                state: {
                    user: testUser,
                    token: testToken,
                    isAuthenticated: true
                },
                version: 0
            }));
            log({ message: 'Test auth token and user data set', token: testToken.substring(0, 50) + '...' });
        }
        
        function clearAuth() {
            const keysToRemove = [
                'reviewinn_jwt_token',
                'reviewinn_refresh_token', 
                'reviewinn_user_data',
                'auth-storage',
                'reviewsite_last_activity'
            ];
            
            keysToRemove.forEach(key => localStorage.removeItem(key));
            log({ message: 'Auth data cleared' });
        }
        
        function checkAuth() {
            const authData = {
                reviewinn_jwt_token: localStorage.getItem('reviewinn_jwt_token'),
                reviewinn_user_data: localStorage.getItem('reviewinn_user_data'),
                'auth-storage': localStorage.getItem('auth-storage'),
                allKeys: Object.keys(localStorage)
            };
            log(authData);
        }
        
        async function testAPI() {
            const token = localStorage.getItem('reviewinn_jwt_token');
            if (!token) {
                log({ error: 'No token found' });
                return;
            }
            
            try {
                const response = await fetch('http://localhost:8000/api/v1/enterprise-notifications/?page=1&limit=20', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                log({
                    status: response.status,
                    statusText: response.statusText,
                    data: data
                });
            } catch (error) {
                log({ error: error.message });
            }
        }
    </script>
</body>
</html>